# Test Routine for Multi Index Tables in BlitzDB

--disable_warnings
drop table if exists t1;
--enable_warnings

# Two Keys: Primary Key + Index
create table t1 (a int, b int, c int, primary key(a), index(b)) engine = blitzdb;
  insert into t1 values (1, 1, 100), (2, 2, 200), (3, 3, 300), (4, 4, 400);
  insert into t1 values (5, 5, 500), (6, 6, 600), (7, 7, 700), (8, 8, 800);
  select * from t1 order by (a);
  select * from t1 order by (a) desc;

  # Primary Key Read
  explain select * from t1 where a <= 4;
  select * from t1 where a <= 4;
  explain select * from t1 where a > 2 and a < 6;
  select * from t1 where a > 2 and a < 6;

  # Index Scan Read
  explain select * from t1 where b <= 4;
  select * from t1 where b <= 4;
  explain select * from t1 where b > 2 and b < 6;
  select * from t1 where b > 2 and b < 6;

  # Needle in a Haystack
  explain select c from t1 where a = 8;
  select c from t1 where a = 8;
  explain select c from t1 where b = 3;
  select c from t1 where b = 3;

  # Delete rows by PK and make sure it can't be fetched with
  # the secondary index. Reason: Row(s) should not exist.
  select * from t1 where a = 1;
  select * from t1 where b = 1;
  delete from t1 where a = 1;
  select * from t1 where a = 1;
  select * from t1 where b = 1;

  select * from t1 where a >= 2 and a <= 4;
  select * from t1 where b >= 2 and b <= 4;
  delete from t1 where a >= 2 and a <= 4;
  select * from t1 where a >= 2 and a <= 4;
  select * from t1 where b >= 2 and b <= 4;
drop table t1;
